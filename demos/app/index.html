<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <title>Sign-in with Microsoft Demo</title>

  <!-- adding Bootstrap 4 for UI components  -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="SHORTCUT ICON" href="https://c.s-microsoft.com/favicon.ico?v2" type="image/x-icon">

  <!-- Styles for the list of provider buttons -->
  <!-- Harmonize with classes in bootstrap.min.css -->
  <style>
    .id-provider-buttons {
      left: 50%;
      transform: translate(-50%, 0);
      top: 200px;
      display: flex;
      flex-direction: column;
    }

    .make-invisible {
      visibility: hidden;
    }

    ol,
    ul {
      list-style: none;
    }

    li {
      padding: 20px 0px;
    }

    .sign-in-button {
      display: flex;
      flex-direction: row;
      -webkit-flex-direction: row;
      flex-wrap: nowrap;
      -webkit-flex-wrap: nowrap;
      -webkit-box-pack: start;
      justify-content: flex-start;
      -webkit-box-align: center;
      align-items: center;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
      -webkit-transition: background-color .218s, border-color .218s;
      transition: background-color .218s, border-color .218s;
      -webkit-user-select: none;
      user-select: none;
      -webkit-appearance: none;
      background-color: #fff;
      background-image: none;
      border: 1px solid #dadce0;
      border-radius: 20px;
      -webkit-border-radius: 20px;
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      outline: none;
      overflow: hidden;
      position: relative;
      text-align: center;
      vertical-align: middle;
      white-space: nowrap;
      display: -webkit-box;
      display: -webkit-flex;
      -webkit-align-items: center;
      height: 40px;
      width: 400px;
    }

    .sign-in-button:hover {
      background-color: rgba(66, 133, 244, 0.04);
      border-color: #d2e3fc;
    }

    .provider-logo {
      width: 24px;
      height: 24px;
      margin-right: 16px;
      color: rgb(90, 76, 219);
    }

    .sign-in-button-text {
      position: relative;
      text-align: center;
      width: 100%;
      color: #3c4043;
      letter-spacing: 0.25px;
    }

    .settings-panel {
      display: none;
      position: absolute;
      right: 0;
      transform: translateX(100%);
      transition: .3s ease-out;
      width: 300px;
      z-index: 1;
    }

    .settings-panel-open {
      display: inline;
      transform: translateX(0%);
    }

    .settings-close-container {
      /* This is the height of the cross button */
      height: 1.5rem;
    }

    .settings-close-button {
      position: absolute;
      right: 5px;
    }
  </style>
</head>

<body>
  <!-- Google identity SDK -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- Navigation bar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <a id="app-name-container" class="navbar-brand" href="/"></a>
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
      </li>
    </ul>
    <!-- Settings button -->
    <div class="btn-group ml-auto dropleft">
      <button type="button" class="btn btn-light btn-outline-success my-2 my-sm-0"
        style="border-radius: 12px; margin-inline-start: 5px;" onclick="settingsUI.handleSettingsButtonClick()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
          <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
          <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
        </svg>
      </button>
      <!-- Sign-in / Sign-out button -->
      <button type="button" id="sign-in" class="btn btn-light btn-outline-success my-2 my-sm-0"
        style="border-radius: 12px; margin-inline-start: 5px;">
        Sign In
      </button>
    </div>
  </nav>
  <h5 id="demo-text-div" class="card-header text-center">Demo</h5>

  <!-- Popup alert container -->
  <div id="alert_container"></div>

  <!-- Setting panel -->
  <div id="settings-panel" class="settings-panel border border-info bg-white">
    <div class="settings-close-container">
      <button type="button" class="close settings-close-button" aria-label="Close" onclick="settingsUI.closeSettings()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="card m-1">
      <div class="card-header">Microsoft Settings</div>
        <a class="card-body" href="https://account.live.com/consent/Edit?client_id=0000000044982429&uaid=39f36ff5fe7c43bd99b029bfe8cab2f2" target="_blank">
          Revoke user permissions</a>
    </div>
    <div class="card m-1">
      <div class="card-header">Microsoft Button Style</div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">
          <label for="ms-button-theme">Choose theme:</label>
          <select name="ms-button-theme" id="ms-button-theme">
            <option value="dark">dark</option>
            <option value="light">light</option>
          </select>
          <label for="ms-button-size">Choose size:</label>
          <select name="ms-button-size" id="ms-button-size">
            <option value="large">large</option>
            <option value="medium">medium</option>
            <option value="small">small</option>
          </select>
          <label for="ms-button-text">Choose text:</label>
          <select name="ms-button-text" id="ms-button-text" style="width: 100px;">
            <option value="signin_with">signin_with</option>
            <option value="signup_with">signup_with</option>
            <option value="continue_with">continue_with</option>
            <option value="signin">signin</option>
          </select>
          <label for="ms-button-shape">Choose shape:</label>
          <select name="ms-button-shape" id="ms-button-shape">
            <option value="rectangular">rectangular</option>
            <option value="pill">pill</option>
            <option value="rounded">rounded</option>
          </select>
          <label for="ms-button-type">Choose type:</label>
          <select name="ms-button-type" id="ms-button-type">
            <option value="standard">standard</option>
            <option value="icon">icon</option>
          </select>
          <label for="ms-button-logo-alignment">Logo alignment:</label>
          <select name="ms-button-logo-alignment" id="ms-button-logo-alignment">
            <option value="left">left</option>
            <option value="center">center</option>
          </select>
          <label for="ms-button-width">Width in pixels:</label>
          <input type="number" id="ms-button-width" min="200" max="600">
          <label for="ms-button-height">Height in pixels:</label>
          <input type="number" id="ms-button-height" min="24" max="100">
        </li>
      </ul>
    </div>
    <div id="microsoft-testing" class="card m-1 d-none">
      <div class="card-header">Microsoft testing</div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">
          Token fetch:
          <button id="microsoft-silent-token-id" type="button" class="btn btn-primary">Silent</button>
          <button id="microsoft-popup-token-id" type="button" class="btn btn-primary">Popup</button>
        </li>
      </ul>
    </div>
    <div class="card m-1">
      <div class="card-header">Google Settings</div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">
          <input type="checkbox" id="google-one-tap-prompt" name="google_one_tap_prompt_option">
          <label for="google-one-tap-prompt">Use one tap prompt</label>
        </li>
        <li class="list-group-item">
          <input type="checkbox" id="google-auto-sign-in" name="google_auto_sign_in_option">
          <label for="google-auto-sign-in">Use automatic sign-in</label>
        </li>
        <li class="list-group-item">
          <input type="checkbox" id="google-revoke-on-sign-out" name="google_revoke_on_sign_out_option">
          <label for="google-revoke-on-sign-out">Revoke OAuth grant on sign-out</label>
        </li>
      </ul>
    </div>
  </div>

  <!-- User profile information when signed-in -->
  <div class="row" style="margin:auto">
    <div id="common-signed-in-content" class="col-md-4 d-none">
      <div class="card text-center">
        <h5 class="card-header" id="WelcomeMessage"></h5>
        <div class="card-body">
          <div><span>You are signed in with </span><span id="id-provider"></span></div>
          <p></p>
          <img id="photo-img" class="d-none" alt="profile image" style="padding: 10px; width:100px; height:100px;">
          <div id="profile-div"></div>
          <button class="btn btn-primary d-none" id="readMail" onclick="msAuth.showMail()">Show Mail</button>
        </div>
      </div>
      <div class="card text-center">
        <h5 class="card-header">Account Information</h5>
        <div id="signed-in-account-info" class="card-body"></div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="list-group" id="list-tab" role="tablist">
      </div>
    </div>
    <div class="col-md-5">
      <div class="tab-content" id="nav-tabContent">
      </div>
    </div>
  </div>

  <!-- Landing page (not signed-in content) -->
  <div id="not-signed-in-content" class="row" style="margin:auto">
    <div style="position:relative">
      <picture>
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1600x600.png?v={2/string}"
          media="(min-width: 1779px)">
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1600x600.png?v={2/string}"
          media="(min-width: 1400px)">
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1259x472.png?v={2/string}"
          media="(min-width: 1084px)">
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1083x609.png?v={2/string}"
          media="(min-width:768px)">
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_767x431.png?v={2/string}"
          media="(min-width:540px)">
        <source
          srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_539x303.png?v={2/string}"
          media="(min-width:0)">
        <img srcset="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1259x472.png?v={2/string}"
          src="https://cdn.graph.office.net/prod/media/identity/Identity_Hero_add-sign-in_1259x472.png?v={2/string}"
          alt="Man wearing headphones at work">
      </picture>
      <div style="position: absolute; top: 50%; left: 25%; transform: translate(-25%, -50%);">
        <div class="card w-50 border-0">
          <div class="card-body">
            <h3 class="card-title">Add sign in with Microsoft</h3>
            <p class="card-text">Give your users a simple, secure way to sign in to your app or website with
              their Microsoft personal account.</p>
            <p class="card-text">This demo site demonstrates signing in with different identity providers, 
              including Microsoft personal account (MSA)</p>
            <p class="card-text">To sign in to this demo site, click the "Sign in" button at the top right of this page.</p> 
            <p class="card-text">To learn more about Microsoft identity platform, click the "Learn more" button below.</p> 
                <a href="https://docs.microsoft.com/azure/active-directory/develop" class="btn btn-primary"
              aria-label="Sign in with Microsoft">
              <span aria-hidden="true">Learn more</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- List of id provider sign-in buttons -->
  <div id="id-provider-buttons" class="card border shadow p-3 mb-5 bg-white rounded-lg position-absolute id-provider-buttons make-invisible">
    <h4 class="card-title">Sign in to your account
      <button type="button" class="close" aria-label="Close" onclick="commonUI.hideSignInProviderButtons()">
        <span aria-hidden="true">&times;</span>
      </button>
    </h4>
    <ul class="card-body">
      <li>
        <div id="ms-auth-initialize" data-client_id="da83df46-4cf9-4b9c-8df7-ad10bbea9793" data-auto_prompt="true"
          data-cancel_on_tap_outside="false" data-auto_sign_in="false" data-callback="handleMicrosoftSignInResponse">
        </div>
        <div class="ms-auth-button" id="ms-auth-button-holder" data-shape="pill"></div>
      </li>
      <!-- Uncomment below to test behavior of `startSignIn`
      <li>
        <button id="ms-auth-user-sign-in-button" class="sign-in-button">
          <div class="provider-logo">
            <svg id="social--microsoft" viewBox="0 0 40 40" fill="none">
              <path fill="#f35325" d="M2 2h17v17H2z">
              </path>
              <path fill="#81bc06" d="M21 2h17v17H21z"></path>
              <path fill="#05a6f0" d="M2 21h17v17H2z"></path>
              <path fill="#ffba08" d="M21 21h17v17H21z"></path>
            </svg>
          </div>
          <span class="sign-in-button-text">Sign in with Microsoft</span>
        </button>
      </li>
      <li>-->
        <!-- This div is needed otherwise the sign-in button below does not show up -->
        <div id="google-button-holder"></div>
      </li>
      <li>
        <div id="fb-sign-in-button" class="d-none">
          <div class="fb-login-button" data-width="400" data-size="large" data-button-type="login_with" data-layout="rounded" 
            data-auto-logout-link="false" data-use-continue-as="true" onlogin="fb.checkLoginState();" data-scope="email"></div>
        </div>
      </li>
    </ul>
  </div>

  <!-- To always use the production EasyAuth service -->
  <!--<script type="text/javascript" src="https://edge-auth.microsoft.com/js/ms_auth_client.js"></script>-->
  <!-- To use one of the EasyAuth service clusters or a local deployment based on URL parameter-->
  <script type="text/javascript" src="./common/easyAuthLoader.js"></script>
  <!-- importing bootstrap.js and supporting js libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

  <!-- importing app scripts (load order is important) -->
  <script type="text/javascript" src="./config/configuration.js"></script>
  <script type="text/javascript" src="./commonModel.js"></script>
  <script type="text/javascript" src="./settingsModel.js"></script>
  <script type="text/javascript" src="./commonUI.js"></script>
  <script type="text/javascript" src="./settingsUI.js"></script>

  <script type="text/javascript" src="./jwt-decode.js"></script>
  <script type="text/javascript" src="./google/googleSignIn.js"></script>
  <script type="text/javascript" src="./easyAuth/easyAuthSignIn.js"></script>
  <script type="text/javascript" src="./fb/fblogin.js"></script>
  </body>
</html>